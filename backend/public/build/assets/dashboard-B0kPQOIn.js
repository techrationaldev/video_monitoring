import{c as C,a as w,j as s,H as D}from"./app-aHe8d4-_.js";import{A as R}from"./app-layout-BSmHkP8Y.js";import{d as E}from"./index-C4J_hXM0.js";import{RoomMonitor as A}from"./room-monitor-oalIDfcz.js";/* empty css            */import"./app-logo-icon-CLiTiGeQ.js";import"./index-1CJKVa_N.js";import"./index-Deu5VM_k.js";import"./index-BCtBPRNr.js";const k=[{title:"Dashboard",href:E().url}];function B(t){const e=C.c(17),{rooms:l}=t;let c;e[0]!==l?(c=l===void 0?[]:l,e[0]=l,e[1]=c):c=e[1];const y=c,[d,S]=w.useState(y),[u,N]=w.useState(!1);let m,f;e[2]===Symbol.for("react.memo_cache_sentinel")?(m=()=>{const _="wss://eyeserver.mytro.in",i=new WebSocket(_);return i.onopen=()=>{console.log("Connected to Mediasoup for Dashboard updates"),N(!0);const h={action:"join-as-admin",roomId:"admin-dashboard"};console.log("Sending join-as-admin:",h),i.send(JSON.stringify(h))},i.onmessage=h=>{try{const n=JSON.parse(h.data);console.log("Dashboard received WS message:",n),n.action==="active-rooms"&&(console.log("Updating rooms list:",n.data),S(n.data))}catch(n){console.error("Error parsing WS message:",n)}},i.onclose=()=>{console.log("Disconnected from Mediasoup"),N(!1)},()=>{i.close()}},f=[],e[2]=m,e[3]=f):(m=e[2],f=e[3]),w.useEffect(m,f);let x;e[4]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx(D,{title:"Dashboard"}),e[4]=x):x=e[4];let p;e[5]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsx("h2",{className:"text-xl font-bold",children:"Active Streams"}),e[5]=p):p=e[5];const b=`flex items-center gap-2 text-sm ${u?"text-green-500":"text-red-500"}`,v=`h-2 w-2 rounded-full ${u?"bg-green-500":"bg-red-500"}`;let o;e[6]!==v?(o=s.jsx("span",{className:v}),e[6]=v,e[7]=o):o=e[7];const j=u?"Real-time Updates Active":"Connecting...";let a;e[8]!==j||e[9]!==b||e[10]!==o?(a=s.jsxs("div",{className:"flex items-center justify-between",children:[p,s.jsxs("div",{className:b,children:[o,j]})]}),e[8]=j,e[9]=b,e[10]=o,e[11]=a):a=e[11];let r;e[12]!==d?(r=d.length===0?s.jsx("div",{className:"text-gray-500",children:"No active rooms found."}):s.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:d.map(I)}),e[12]=d,e[13]=r):r=e[13];let g;return e[14]!==a||e[15]!==r?(g=s.jsxs(R,{breadcrumbs:k,children:[x,s.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[a,r]})]}),e[14]=a,e[15]=r,e[16]=g):g=e[16],g}function I(t){return s.jsxs("div",{className:"rounded-lg border bg-white p-4 shadow-sm dark:bg-sidebar",children:[s.jsxs("h3",{className:"mb-2 flex items-center justify-between font-semibold",children:[s.jsx("span",{children:t.name}),t.viewerCount!==void 0&&s.jsxs("span",{className:"text-xs text-gray-500",children:[t.viewerCount," viewers"]})]}),s.jsx("div",{className:"aspect-video overflow-hidden rounded bg-black",children:s.jsx(A,{roomId:t.name,variant:"card"})})]},t.id)}export{B as default};
