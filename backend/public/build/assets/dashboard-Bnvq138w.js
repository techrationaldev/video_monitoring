import{c as k,a as N,j as s,H as E,L as D}from"./app-CZUj66FS.js";import{A as M}from"./app-layout-DISXQRrf.js";import{d as R}from"./index-C4J_hXM0.js";import{RoomMonitor as C}from"./room-monitor-COrWbGzW.js";import{a as L}from"./app-logo-icon-Buw9npA-.js";/* empty css            */import"./index-BwsFhh2Y.js";import"./index-DpMmdf_z.js";import"./index-98mII7Yx.js";import"./refresh-cw-BYZagS7z.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],I=L("ExternalLink",$),A=[{title:"Dashboard",href:R().url}];function Q(t){const e=k.c(17),{rooms:l}=t;let c;e[0]!==l?(c=l===void 0?[]:l,e[0]=l,e[1]=c):c=e[1];const y=c,[d,S]=N.useState(y),[u,w]=N.useState(!1);let m,f;e[2]===Symbol.for("react.memo_cache_sentinel")?(m=()=>{const _="ws://192.168.1.14:5005",i=new WebSocket(_);return i.onopen=()=>{console.log("Connected to Mediasoup for Dashboard updates"),w(!0);const g={action:"join-as-admin",roomId:"admin-dashboard"};console.log("Sending join-as-admin:",g),i.send(JSON.stringify(g))},i.onmessage=g=>{try{const o=JSON.parse(g.data);console.log("Dashboard received WS message:",o),o.action==="active-rooms"&&(console.log("Updating rooms list:",o.data),o.data.forEach(H),S(o.data))}catch(o){console.error("Error parsing WS message:",o)}},i.onclose=()=>{console.log("Disconnected from Mediasoup"),w(!1)},()=>{i.close()}},f=[],e[2]=m,e[3]=f):(m=e[2],f=e[3]),N.useEffect(m,f);let x;e[4]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx(E,{title:"Dashboard"}),e[4]=x):x=e[4];let p;e[5]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsx("h2",{className:"text-xl font-bold",children:"Active Streams"}),e[5]=p):p=e[5];const b=`flex items-center gap-2 text-sm ${u?"text-green-500":"text-red-500"}`,v=`h-2 w-2 rounded-full ${u?"bg-green-500":"bg-red-500"}`;let a;e[6]!==v?(a=s.jsx("span",{className:v}),e[6]=v,e[7]=a):a=e[7];const j=u?"Real-time Updates Active":"Connecting...";let r;e[8]!==j||e[9]!==b||e[10]!==a?(r=s.jsxs("div",{className:"flex items-center justify-between",children:[p,s.jsxs("div",{className:b,children:[a,j]})]}),e[8]=j,e[9]=b,e[10]=a,e[11]=r):r=e[11];let n;e[12]!==d?(n=d.length===0?s.jsx("div",{className:"text-gray-500",children:"No active rooms found."}):s.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:d.map(q)}),e[12]=d,e[13]=n):n=e[13];let h;return e[14]!==r||e[15]!==n?(h=s.jsxs(M,{breadcrumbs:A,children:[x,s.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[r,n]})]}),e[14]=r,e[15]=n,e[16]=h):h=e[16],h}function q(t){return s.jsxs("div",{className:"rounded-lg border bg-white p-4 shadow-sm dark:bg-sidebar",children:[s.jsxs("h3",{className:"mb-2 flex items-center justify-between font-semibold",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{children:t.name}),s.jsx(D,{href:`/rooms/${t.name}/monitor`,className:"text-gray-500 hover:text-blue-600",title:"Open Full Monitor",children:s.jsx(I,{size:16})})]}),t.viewerCount!==void 0&&s.jsxs("span",{className:"text-xs text-gray-500",children:[t.viewerCount," viewers"]})]}),s.jsx("div",{className:"aspect-video overflow-hidden rounded bg-black",children:s.jsx(C,{roomId:t.name,variant:"card"})})]},t.id)}function H(t){return console.log(`Room ID: ${t.id}, Name: ${t.name}`)}export{Q as default};
