import{c as D,a as N,j as s,H as R}from"./app-RTcY-n5c.js";import{A as C}from"./app-layout-jlA_Hse4.js";import{d as E}from"./index-C4J_hXM0.js";import{RoomMonitor as $}from"./room-monitor-BaqKgovI.js";/* empty css            */import"./app-logo-icon-B_501DtH.js";import"./index-CmeQD44-.js";import"./index-BNkOUdRb.js";import"./index-BCtBPRNr.js";import"./refresh-cw-Ca_ABoIy.js";const A=[{title:"Dashboard",href:E().url}];function G(t){const e=D.c(17),{rooms:l}=t;let c;e[0]!==l?(c=l===void 0?[]:l,e[0]=l,e[1]=c):c=e[1];const y=c,[d,S]=N.useState(y),[u,w]=N.useState(!1);let m,f;e[2]===Symbol.for("react.memo_cache_sentinel")?(m=()=>{const _="wss://eyeserver.mytro.in",i=new WebSocket(_);return i.onopen=()=>{console.log("Connected to Mediasoup for Dashboard updates"),w(!0);const h={action:"join-as-admin",roomId:"admin-dashboard"};console.log("Sending join-as-admin:",h),i.send(JSON.stringify(h))},i.onmessage=h=>{try{const o=JSON.parse(h.data);console.log("Dashboard received WS message:",o),o.action==="active-rooms"&&(console.log("Updating rooms list:",o.data),o.data.forEach(k),S(o.data))}catch(o){console.error("Error parsing WS message:",o)}},i.onclose=()=>{console.log("Disconnected from Mediasoup"),w(!1)},()=>{i.close()}},f=[],e[2]=m,e[3]=f):(m=e[2],f=e[3]),N.useEffect(m,f);let p;e[4]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsx(R,{title:"Dashboard"}),e[4]=p):p=e[4];let x;e[5]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx("h2",{className:"text-xl font-bold",children:"Active Streams"}),e[5]=x):x=e[5];const b=`flex items-center gap-2 text-sm ${u?"text-green-500":"text-red-500"}`,v=`h-2 w-2 rounded-full ${u?"bg-green-500":"bg-red-500"}`;let a;e[6]!==v?(a=s.jsx("span",{className:v}),e[6]=v,e[7]=a):a=e[7];const j=u?"Real-time Updates Active":"Connecting...";let r;e[8]!==j||e[9]!==b||e[10]!==a?(r=s.jsxs("div",{className:"flex items-center justify-between",children:[x,s.jsxs("div",{className:b,children:[a,j]})]}),e[8]=j,e[9]=b,e[10]=a,e[11]=r):r=e[11];let n;e[12]!==d?(n=d.length===0?s.jsx("div",{className:"text-gray-500",children:"No active rooms found."}):s.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:d.map(I)}),e[12]=d,e[13]=n):n=e[13];let g;return e[14]!==r||e[15]!==n?(g=s.jsxs(C,{breadcrumbs:A,children:[p,s.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[r,n]})]}),e[14]=r,e[15]=n,e[16]=g):g=e[16],g}function I(t){return s.jsxs("div",{className:"rounded-lg border bg-white p-4 shadow-sm dark:bg-sidebar",children:[s.jsxs("h3",{className:"mb-2 flex items-center justify-between font-semibold",children:[s.jsx("span",{children:t.name}),t.viewerCount!==void 0&&s.jsxs("span",{className:"text-xs text-gray-500",children:[t.viewerCount," viewers"]})]}),s.jsx("div",{className:"aspect-video overflow-hidden rounded bg-black",children:s.jsx($,{roomId:t.name,variant:"card"})})]},t.id)}function k(t){return console.log(`Room ID: ${t.id}, Name: ${t.name}`)}export{G as default};
