import{a as i,j as e,b as re}from"./app-D2mlBllE.js";import{l as ce,A as de,M as le,a as ue}from"./index-BC3t8BBF.js";import{c as C}from"./createLucideIcon-DH_CpfcI.js";import{S as he}from"./settings-BTBt4rJi.js";/* empty css            *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16",key:"qmtpty"}],["path",{d:"M9.5 4h5L17 7h3a2 2 0 0 1 2 2v7.5",key:"1ufyfc"}],["path",{d:"M14.121 15.121A3 3 0 1 1 9.88 10.88",key:"11zox6"}]],G=C("CameraOff",me);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],fe=C("Camera",pe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]],U=C("PhoneOff",xe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]],ge=C("Signal",ve);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],we=C("Volume2",be);function Te({onReady:k}){const[t,o]=i.useState([]),[n,p]=i.useState([]),[x,v]=i.useState(""),[b,D]=i.useState(""),[l,P]=i.useState(!0),[u,L]=i.useState(!0),[f,y]=i.useState(null),g=i.useRef(null);i.useEffect(()=>{I()},[]),i.useEffect(()=>(j(),()=>{f&&f.getTracks().forEach(a=>a.stop())}),[x,b]),i.useEffect(()=>{f&&(f.getVideoTracks().forEach(a=>a.enabled=l),f.getAudioTracks().forEach(a=>a.enabled=u))},[l,u,f]);const I=async()=>{try{await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});const a=await navigator.mediaDevices.enumerateDevices();o(a.filter(T=>T.kind==="videoinput")),p(a.filter(T=>T.kind==="audioinput"));const S=a.find(T=>T.kind==="videoinput"),w=a.find(T=>T.kind==="audioinput");S&&v(S.deviceId),w&&D(w.deviceId)}catch(a){console.error("Error getting devices:",a)}},j=async()=>{f&&f.getTracks().forEach(a=>a.stop());try{const a=await navigator.mediaDevices.getUserMedia({video:x?{deviceId:{exact:x}}:!0,audio:b?{deviceId:{exact:b}}:!0});y(a),g.current&&(g.current.srcObject=a)}catch(a){console.error("Error starting preview:",a)}},A=()=>{f&&k(f,l,u)};return e.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gray-900 p-4 text-white",children:e.jsxs("div",{className:"w-full max-w-md overflow-hidden rounded-xl bg-gray-800 shadow-2xl",children:[e.jsxs("div",{className:"relative aspect-video bg-black",children:[e.jsx("video",{ref:g,autoPlay:!0,muted:!0,playsInline:!0,className:`h-full w-full object-cover ${l?"":"hidden"}`}),!l&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:"Camera Off"}),e.jsxs("div",{className:"absolute right-0 bottom-4 left-0 flex justify-center gap-4",children:[e.jsx("button",{onClick:()=>L(!u),className:`rounded-full p-3 ${u?"bg-gray-700 hover:bg-gray-600":"bg-red-500 hover:bg-red-600"} transition-colors`,children:u?"Mic On":"Mic Off"}),e.jsx("button",{onClick:()=>P(!l),className:`rounded-full p-3 ${l?"bg-gray-700 hover:bg-gray-600":"bg-red-500 hover:bg-red-600"} transition-colors`,children:l?"Cam On":"Cam Off"})]})]}),e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-400",children:"Camera"}),e.jsx("select",{value:x,onChange:a=>v(a.target.value),className:"w-full rounded-lg border-none bg-gray-700 px-3 py-2 text-white focus:ring-2 focus:ring-indigo-500",children:t.map(a=>e.jsx("option",{value:a.deviceId,children:a.label||`Camera ${a.deviceId.slice(0,5)}...`},a.deviceId))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-400",children:"Microphone"}),e.jsx("select",{value:b,onChange:a=>D(a.target.value),className:"w-full rounded-lg border-none bg-gray-700 px-3 py-2 text-white focus:ring-2 focus:ring-indigo-500",children:n.map(a=>e.jsx("option",{value:a.deviceId,children:a.label||`Mic ${a.deviceId.slice(0,5)}...`},a.deviceId))})]}),e.jsx("button",{onClick:A,className:"mt-4 w-full rounded-lg bg-indigo-600 px-4 py-3 font-bold text-white transition-colors hover:bg-indigo-700",children:"Start Streaming"})]})]})})}class ke{ws;device=null;sendTransport;recvTransport;producers=new Map;consumers=new Map;audioProducer=null;videoProducer=null;roomId;clientId;deviceLoadedPromise;deviceLoadedResolver=null;transportReadyPromise;transportReadyResolver=null;onTrackCallback=null;onTrackEndedCallback=null;constructor(t,o,n){this.ws=new WebSocket(t),this.roomId=o,this.clientId=n,this.deviceLoadedPromise=new Promise(p=>{this.deviceLoadedResolver=p}),this.transportReadyPromise=new Promise(p=>{this.transportReadyResolver=p}),console.log("[CLIENT] WebRTC Client Created, room:",o,"client:",n)}onTrack(t){this.onTrackCallback=t}onTrackEnded(t){this.onTrackEndedCallback=t}onMessage(t){this.ws.onmessage=o=>{const n=JSON.parse(o.data);console.log(`[CLIENT] WS RECV: ${n.action}`,n),n.action==="restart-ice-done"&&this.handleRestartIceDone(n.data),n.action==="create-recv-transport"&&this.createRecvTransport(n.data),n.action==="new-producer"&&this.consume(n.data.producerId),n.action==="producer-closed"&&this.handleProducerClosed(n.data),n.action==="consume-done"&&this.handleConsumeDone(n.data),n.action==="session-ended"&&(console.warn("[CLIENT] Session ended by server (restart?), reloading..."),window.location.reload()),t(n)}}handleProducerClosed(t){const{producerId:o}=t;console.log("[CLIENT] Producer closed:",o);for(const[n,p]of this.consumers)if(p.producerId===o){console.log("[CLIENT] Closing consumer:",n),p.close(),this.consumers.delete(n),this.onTrackEndedCallback&&this.onTrackEndedCallback(p.track.id);break}}send(t){const o={...t,clientId:this.clientId};console.log(`[CLIENT] WS SEND: ${t.action}`,o),this.ws.send(JSON.stringify(o))}async init(){return new Promise(t=>{this.connectWs(t)})}connectWs(t){this.ws=new WebSocket(this.ws.url),this.ws.onopen=()=>{console.log("[CLIENT] WS CONNECTED"),this.send({action:"join-as-streamer",roomId:this.roomId}),this.send({action:"create-recv-transport",roomId:this.roomId}),t&&t()},this.ws.onclose=()=>{console.log("[CLIENT] WS CLOSED, reconnecting in 3s..."),setTimeout(()=>this.connectWs(),3e3)},this.ws.onerror=o=>{console.error("[CLIENT] WS ERROR:",o),this.ws.close()},this.onMessage(o=>{})}async loadDevice(t){console.log("[CLIENT] Loading device with capabilities:",t),this.device=new ce.Device,await this.device.load({routerRtpCapabilities:t}),console.log("[CLIENT] Device loaded"),this.deviceLoadedResolver&&this.deviceLoadedResolver()}async createSendTransport(t){if(console.log("[CLIENT] createSendTransport options received:",t),!t){console.error("[CLIENT] ERROR! createSendTransport called with EMPTY options");return}if(await this.deviceLoadedPromise,!this.device){console.error("[CLIENT] Device is null after waiting!");return}this.sendTransport=this.device.createSendTransport(t),this.transportReadyResolver&&this.transportReadyResolver(),this.sendTransport.on("connect",({dtlsParameters:o},n)=>{console.log("[CLIENT] Transport connect"),this.send({action:"connect-transport",roomId:this.roomId,data:{transportId:this.sendTransport.id,dtlsParameters:o}}),n()}),this.sendTransport.on("connectionstatechange",async o=>{console.log(`[CLIENT] Send Transport connection state changed: ${o}`),(o==="failed"||o==="disconnected")&&(console.warn("[CLIENT] Transport failed/disconnected. Not restarting ICE to avoid loops. Reloading..."),window.location.reload())}),this.sendTransport.on("produce",({kind:o,rtpParameters:n},p)=>{console.log("[CLIENT] Transport produce"),this.send({action:"produce",roomId:this.roomId,data:{transportId:this.sendTransport.id,kind:o,rtpParameters:n,appData:arguments[0].appData}});const x=v=>{const b=JSON.parse(v.data);b.action==="produce-done"&&(console.log("[CLIENT] producer created:",b.producerId),p({id:b.producerId}),this.ws.removeEventListener("message",x))};this.ws.addEventListener("message",x)})}async produceStream(t,o={}){if(await this.transportReadyPromise,!this.sendTransport){console.error("[CLIENT] sendTransport is not ready!");return}const n=t.getVideoTracks()[0];n&&(console.log("[CLIENT] Producing video track..."),this.videoProducer=await this.sendTransport.produce({track:n,encodings:[{maxBitrate:1e5,scaleResolutionDownBy:4},{maxBitrate:3e5,scaleResolutionDownBy:2},{maxBitrate:9e5,scaleResolutionDownBy:1}],codecOptions:{videoGoogleStartBitrate:1e3},appData:{...o,source:"webcam"}}),this.producers.set("video",this.videoProducer));const p=t.getAudioTracks()[0];p&&(console.log("[CLIENT] Producing audio track..."),this.audioProducer=await this.sendTransport.produce({track:p,appData:{...o,source:"mic"}}),this.producers.set("audio",this.audioProducer))}async replaceVideoTrack(t){this.videoProducer&&await this.videoProducer.replaceTrack({track:t})}async replaceAudioTrack(t){this.audioProducer&&await this.audioProducer.replaceTrack({track:t})}muteAudio(){this.audioProducer&&this.audioProducer.pause()}unmuteAudio(){this.audioProducer&&this.audioProducer.resume()}pauseVideo(){this.videoProducer&&this.videoProducer.pause()}resumeVideo(){this.videoProducer&&this.videoProducer.resume()}restartIce(t){this.send({action:"restart-ice",roomId:this.roomId,data:{transportId:t}})}async handleRestartIceDone(t){const{transportId:o,iceParameters:n}=t;this.sendTransport&&this.sendTransport.id===o&&(console.log("[CLIENT] Restarting ICE with new parameters"),await this.sendTransport.restartIce({iceParameters:n}))}handleAdminAction(t,o){switch(console.log(`[CLIENT] Handling admin action: ${t}`,o),t){case"mute-audio":this.muteAudio();break;case"unmute-audio":this.unmuteAudio();break;case"mute-video":this.pauseVideo();break;case"unmute-video":this.resumeVideo();break;case"reload":window.location.reload();break;default:console.warn(`[CLIENT] Unknown admin action: ${t}`)}}async createRecvTransport(t){if(console.log("[CLIENT] createRecvTransport options received:",t),await this.deviceLoadedPromise,!this.device){console.error("[CLIENT] Device is null after waiting!");return}this.recvTransport=this.device.createRecvTransport(t),this.recvTransport.on("connect",({dtlsParameters:o},n)=>{console.log("[CLIENT] Recv Transport connect"),this.send({action:"connect-transport",roomId:this.roomId,data:{transportId:this.recvTransport.id,dtlsParameters:o}}),n()}),this.recvTransport.on("connectionstatechange",async o=>{console.log(`[CLIENT] Recv Transport connection state changed: ${o}`)})}async consume(t){if(console.log("[CLIENT] Attempting to consume producer:",t),await this.deviceLoadedPromise,!this.device||!this.recvTransport){console.warn("[CLIENT] Device or RecvTransport not ready");return}const o=this.device.rtpCapabilities;this.send({action:"consume",roomId:this.roomId,data:{transportId:this.recvTransport.id,producerId:t,rtpCapabilities:o}})}async handleConsumeDone(t){const{id:o,producerId:n,kind:p,rtpParameters:x}=t;if(console.log("[CLIENT] handleConsumeDone:",o,p),!this.recvTransport)return;const v=await this.recvTransport.consume({id:o,producerId:n,kind:p,rtpParameters:x});this.consumers.set(v.id,v),this.onTrackCallback&&this.onTrackCallback(v.track),this.send({action:"resume-consumer",roomId:this.roomId,data:{consumerId:v.id}})}close(){console.log("[CLIENT] Closing client..."),this.producers.forEach(t=>{t.close()}),this.producers.clear(),this.consumers.forEach(t=>{t.close()}),this.consumers.clear(),this.sendTransport&&(this.sendTransport.close(),this.sendTransport=null),this.recvTransport&&(this.recvTransport.close(),this.recvTransport=null),this.ws&&this.ws.close(),console.log("[CLIENT] Client closed")}}function Ee(){const k=i.useRef(null),[t,o]=i.useState(!1),[n,p]=i.useState(0),[x,v]=i.useState(!1),[b,D]=i.useState(!1),[l,P]=i.useState(null),[u,L]=i.useState(null),[f,y]=i.useState(!0),[g,I]=i.useState(!0),[j,A]=i.useState(!1),[a,S]=i.useState(null),w=i.useRef(null),[T,B]=i.useState([]),[F,q]=i.useState([]),[O,H]=i.useState([]),[M,z]=i.useState(""),[V,$]=i.useState(""),[_,W]=i.useState(""),[J,Q]=i.useState(0),[Y,R]=i.useState("Excellent");i.useEffect(()=>{let s;return t&&(s=setInterval(()=>{Q(c=>c+1)},1e3)),()=>clearInterval(s)},[t]);const K=s=>{const c=Math.floor(s/3600),h=Math.floor(s%3600/60),r=s%60;return`${c.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`};i.useEffect(()=>{const s=async()=>{try{const c=await navigator.mediaDevices.enumerateDevices(),h=c.filter(m=>m.kind==="videoinput"),r=c.filter(m=>m.kind==="audioinput"),d=c.filter(m=>m.kind==="audiooutput");B(h),q(r),H(d),h.length>0&&!M&&z(h[0].deviceId),r.length>0&&!V&&$(r[0].deviceId),d.length>0&&!_&&W(d[0].deviceId)}catch(c){console.error("[PAGE] Failed to enumerate devices:",c)}};return s(),navigator.mediaDevices.addEventListener("devicechange",s),()=>navigator.mediaDevices.removeEventListener("devicechange",s)},[]);const X=(s,c,h)=>{P(s),I(c),y(h),v(!0),Z(s)},Z=s=>{let c=localStorage.getItem("stream_room_id");c||(c=`client-${Date.now()}`,localStorage.setItem("stream_room_id",c));let h=sessionStorage.getItem(`stream_connection_id_${c}`);h||(h=crypto.randomUUID(),sessionStorage.setItem(`stream_connection_id_${c}`,h)),re.post(`/api/rooms/${c}/join`,{connection_id:h}).then(()=>{console.log("[PAGE] Session created in DB");const r=new ke("wss://eyeserver.mytro.in",c,h);L(r),r.onTrack(d=>{console.log("[PAGE] Received remote track:",d.kind,d.id),d.kind==="audio"&&S(d)}),r.onTrackEnded(d=>{console.log("[PAGE] Track ended:",d),S(m=>m&&m.id===d?null:m)}),r.init().then(()=>{r.onMessage(async d=>{if(d.action==="router-rtp-capabilities"&&await r.loadDevice(d.data),d.action==="create-send-transport"&&d.data&&await r.createSendTransport(d.data),d.action==="start-produce"){const m=navigator.userAgent;let N="Unknown OS";m.indexOf("Win")!==-1&&(N="Windows"),m.indexOf("Mac")!==-1&&(N="macOS"),m.indexOf("Linux")!==-1&&(N="Linux"),m.indexOf("Android")!==-1&&(N="Android"),m.indexOf("like Mac")!==-1&&(N="iOS");let E="Unknown Browser";m.indexOf("Chrome")!==-1&&(E="Chrome"),m.indexOf("Firefox")!==-1&&(E="Firefox"),m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1&&(E="Safari"),m.indexOf("Edge")!==-1&&(E="Edge");const ie={os:N,browser:E,ip:"127.0.0.1"};await r.produceStream(s,ie),o(!0)}d.action==="viewer-count"&&p(d.count),d.action==="session-ended"&&(console.warn("[PAGE] Session ended by server, reloading..."),window.location.reload()),d.action==="admin-action"&&r&&r.handleAdminAction(d.data.type,d.data.payload)})})}).catch(r=>console.error("[PAGE] Failed to join room API:",r))};i.useEffect(()=>{if(!t||!u)return;const s=setInterval(async()=>{if(u.sendTransport){const c=await u.sendTransport.getStats();let h=0;c.forEach(r=>{r.type==="candidate-pair"&&r.state==="succeeded"&&(h=r.currentRoundTripTime*1e3),r.type==="outbound-rtp"&&r.kind}),h<100?R("Excellent"):h<300?R("Good"):R("Poor")}},2e3);return()=>clearInterval(s)},[t,u]),i.useEffect(()=>{k.current&&l&&(k.current.srcObject=l)},[l,t]),i.useEffect(()=>{if(w.current&&a){console.log("[PAGE] Playing remote audio track");const s=new MediaStream([a]);w.current.srcObject=s,w.current.play().catch(c=>console.error("[PAGE] Remote audio play failed:",c))}},[a]);const ee=()=>{u&&(f?u.muteAudio():u.unmuteAudio(),y(!f))},te=()=>{u&&(g?u.pauseVideo():u.resumeVideo(),I(!g))},se=async s=>{try{const h=(await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:s}}})).getVideoTracks()[0];if(u&&await u.replaceVideoTrack(h),l){const r=l.getVideoTracks()[0];r&&(l.removeTrack(r),r.stop()),l.addTrack(h),k.current&&(k.current.srcObject=l)}z(s),I(!0)}catch(c){console.error("[PAGE] Failed to switch camera:",c)}},oe=async s=>{try{const h=(await navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:s}}})).getAudioTracks()[0];if(u&&await u.replaceAudioTrack(h),l){const r=l.getAudioTracks()[0];r&&(l.removeTrack(r),r.stop()),l.addTrack(h)}$(s),y(!0)}catch(c){console.error("[PAGE] Failed to switch microphone:",c)}},ae=async s=>{try{w.current&&"setSinkId"in w.current?(await w.current.setSinkId(s),W(s)):console.warn("Audio output selection not supported")}catch(c){console.error("Failed to set audio output device:",c)}},ne=()=>{confirm("Are you sure you want to end the stream?")&&(u&&u.close(),l&&l.getTracks().forEach(s=>s.stop()),o(!1),D(!0))};return b?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-black p-6 text-white",children:e.jsxs("div",{className:"w-full max-w-md rounded-xl border border-zinc-800 bg-zinc-900 p-8 text-center shadow-2xl",children:[e.jsx("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full bg-red-500/10",children:e.jsx(U,{className:"h-10 w-10 text-red-500"})}),e.jsx("h2",{className:"mb-2 text-3xl font-bold text-white",children:"Stream Ended"}),e.jsx("p",{className:"mb-8 text-zinc-400",children:"The streaming session has been terminated successfully."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"w-full rounded-lg bg-blue-600 px-6 py-3 font-medium text-white transition-colors hover:bg-blue-700",children:"Start New Stream"})]})}):x?e.jsxs("div",{className:"relative h-screen w-screen overflow-hidden bg-black text-white",children:[e.jsx("video",{ref:k,autoPlay:!0,muted:!0,playsInline:!0,className:`h-full w-full object-contain ${g?"":"opacity-0"}`}),!g&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-zinc-900/90",children:[e.jsx(G,{className:"mb-4 h-16 w-16 text-zinc-600"}),e.jsx("span",{className:"text-xl font-medium text-zinc-400",children:"Camera Paused"})]}),e.jsxs("div",{className:"pointer-events-none absolute top-0 right-0 left-0 flex items-start justify-between bg-gradient-to-b from-black/80 to-transparent p-6",children:[e.jsxs("div",{className:"pointer-events-auto flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2 rounded-full border border-zinc-800 bg-zinc-900/80 px-3 py-1.5 backdrop-blur-md",children:t?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"relative flex h-2.5 w-2.5",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex h-2.5 w-2.5 rounded-full bg-red-500"})]}),e.jsx("span",{className:"text-xs font-bold tracking-wider text-red-500",children:"LIVE"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-2.5 w-2.5 animate-pulse rounded-full bg-yellow-500"}),e.jsx("span",{className:"text-xs font-bold tracking-wider text-yellow-500",children:"CONNECTING"})]})}),e.jsx("div",{className:"rounded-full border border-zinc-800 bg-zinc-900/80 px-3 py-1.5 font-mono text-sm text-zinc-300 backdrop-blur-md",children:K(J)})]}),e.jsx("div",{className:"pointer-events-auto flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 rounded-full border border-green-500/20 bg-green-500/10 px-3 py-1.5 backdrop-blur-md",children:[e.jsx(ge,{className:"h-3.5 w-3.5 text-green-500"}),e.jsx("span",{className:"text-xs font-medium text-green-500",children:Y})]})})]}),e.jsx("div",{className:"pointer-events-none absolute bottom-28 left-6",children:e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-zinc-800 bg-zinc-900/80 px-4 py-2 backdrop-blur-md",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-blue-600 text-xs font-bold",children:"YOU"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-white",children:"Client Stream"}),e.jsx("span",{className:"font-mono text-xs text-zinc-400",children:localStorage.getItem("stream_room_id")})]}),e.jsx("div",{className:"mx-1 h-4 w-[1px] bg-zinc-700"}),e.jsx(de,{className:"h-4 w-4 text-green-500"})]})}),e.jsx("audio",{ref:w,autoPlay:!0}),a&&e.jsx("div",{className:"pointer-events-auto absolute top-24 right-6 animate-in duration-300 fade-in slide-in-from-right",children:e.jsxs("div",{className:"flex animate-pulse items-center gap-3 rounded-lg bg-red-500 px-4 py-2 text-white shadow-lg",children:[e.jsx(we,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-bold",children:"Admin Speaking..."})]})}),e.jsxs("div",{className:"absolute bottom-8 left-1/2 flex -translate-x-1/2 items-center gap-3 rounded-2xl border border-zinc-800 bg-zinc-900/90 p-2 shadow-2xl backdrop-blur-xl",children:[e.jsx("button",{onClick:ee,className:`rounded-xl p-3.5 transition-all duration-200 ${f?"bg-zinc-800 text-white hover:bg-zinc-700":"border border-red-500/50 bg-red-500/10 text-red-500 hover:bg-red-500/20"}`,title:f?"Mute Mic":"Unmute Mic",children:f?e.jsx(le,{className:"h-5 w-5"}):e.jsx(ue,{className:"h-5 w-5"})}),e.jsx("button",{onClick:te,className:`rounded-xl p-3.5 transition-all duration-200 ${g?"bg-zinc-800 text-white hover:bg-zinc-700":"border border-red-500/50 bg-red-500/10 text-red-500 hover:bg-red-500/20"}`,title:g?"Turn Off Camera":"Turn On Camera",children:g?e.jsx(fe,{className:"h-5 w-5"}):e.jsx(G,{className:"h-5 w-5"})}),e.jsx("div",{className:"mx-1 h-8 w-[1px] bg-zinc-800"}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>A(!j),className:`rounded-xl p-3.5 transition-all duration-200 ${j?"bg-blue-600 text-white":"bg-zinc-800 text-white hover:bg-zinc-700"}`,title:"Settings",children:e.jsx(he,{className:"h-5 w-5"})}),j&&e.jsxs("div",{className:"absolute bottom-full left-1/2 mb-4 w-72 -translate-x-1/2 animate-in rounded-xl border border-zinc-800 bg-zinc-900 p-4 shadow-2xl duration-200 zoom-in-95",children:[e.jsx("h3",{className:"mb-3 text-xs font-bold tracking-wider text-zinc-500 uppercase",children:"Device Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-xs text-zinc-400",children:"Camera"}),e.jsx("select",{value:M,onChange:s=>se(s.target.value),className:"w-full rounded-lg border border-zinc-800 bg-zinc-950 px-2.5 py-2 text-sm text-white outline-none focus:border-transparent focus:ring-2 focus:ring-blue-600",children:T.map(s=>e.jsx("option",{value:s.deviceId,children:s.label||`Camera ${s.deviceId.slice(0,5)}...`},s.deviceId))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-xs text-zinc-400",children:"Microphone"}),e.jsx("select",{value:V,onChange:s=>oe(s.target.value),className:"w-full rounded-lg border border-zinc-800 bg-zinc-950 px-2.5 py-2 text-sm text-white outline-none focus:border-transparent focus:ring-2 focus:ring-blue-600",children:F.map(s=>e.jsx("option",{value:s.deviceId,children:s.label||`Mic ${s.deviceId.slice(0,5)}...`},s.deviceId))})]}),O.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-xs text-zinc-400",children:"Speaker"}),e.jsx("select",{value:_,onChange:s=>ae(s.target.value),className:"w-full rounded-lg border border-zinc-800 bg-zinc-950 px-2.5 py-2 text-sm text-white outline-none focus:border-transparent focus:ring-2 focus:ring-blue-600",children:O.map(s=>e.jsx("option",{value:s.deviceId,children:s.label||`Speaker ${s.deviceId.slice(0,5)}...`},s.deviceId))})]})]})]})]}),e.jsxs("button",{onClick:ne,className:"flex items-center gap-2 rounded-xl bg-red-600 px-6 py-3.5 text-sm font-bold text-white transition-all duration-200 hover:bg-red-700",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{children:"End Stream"})]})]})]}):e.jsx(Te,{onReady:X})}export{Ee as default};
