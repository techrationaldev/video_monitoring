import{a as n,j as t,c as Me,b as Ve}from"./app-Clx9Z3P1.js";import{l as $e,A as Oe}from"./index-D8RgqC9n.js";/* empty css            */function We({onReady:e}){const[s,o]=n.useState([]),[r,h]=n.useState([]),[v,x]=n.useState(""),[k,X]=n.useState(""),[y,a]=n.useState(!0),[N,d]=n.useState(!0),[g,b]=n.useState(null),j=n.useRef(null);n.useEffect(()=>{f()},[]),n.useEffect(()=>(Q(),()=>{g&&g.getTracks().forEach(i=>i.stop())}),[v,k]),n.useEffect(()=>{g&&(g.getVideoTracks().forEach(i=>i.enabled=y),g.getAudioTracks().forEach(i=>i.enabled=N))},[y,N,g]);const f=async()=>{try{await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});const i=await navigator.mediaDevices.enumerateDevices();o(i.filter(w=>w.kind==="videoinput")),h(i.filter(w=>w.kind==="audioinput"));const C=i.find(w=>w.kind==="videoinput"),E=i.find(w=>w.kind==="audioinput");C&&x(C.deviceId),E&&X(E.deviceId)}catch(i){console.error("Error getting devices:",i)}},Q=async()=>{g&&g.getTracks().forEach(i=>i.stop());try{const i=await navigator.mediaDevices.getUserMedia({video:v?{deviceId:{exact:v}}:!0,audio:k?{deviceId:{exact:k}}:!0});b(i),j.current&&(j.current.srcObject=i)}catch(i){console.error("Error starting preview:",i)}},T=()=>{g&&e(g,y,N)};return t.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gray-900 p-4 text-white",children:t.jsxs("div",{className:"w-full max-w-md overflow-hidden rounded-xl bg-gray-800 shadow-2xl",children:[t.jsxs("div",{className:"relative aspect-video bg-black",children:[t.jsx("video",{ref:j,autoPlay:!0,muted:!0,playsInline:!0,className:`h-full w-full object-cover ${y?"":"hidden"}`}),!y&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:"Camera Off"}),t.jsxs("div",{className:"absolute right-0 bottom-4 left-0 flex justify-center gap-4",children:[t.jsx("button",{onClick:()=>d(!N),className:`rounded-full p-3 ${N?"bg-gray-700 hover:bg-gray-600":"bg-red-500 hover:bg-red-600"} transition-colors`,children:N?"Mic On":"Mic Off"}),t.jsx("button",{onClick:()=>a(!y),className:`rounded-full p-3 ${y?"bg-gray-700 hover:bg-gray-600":"bg-red-500 hover:bg-red-600"} transition-colors`,children:y?"Cam On":"Cam Off"})]})]}),t.jsxs("div",{className:"space-y-4 p-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-400",children:"Camera"}),t.jsx("select",{value:v,onChange:i=>x(i.target.value),className:"w-full rounded-lg border-none bg-gray-700 px-3 py-2 text-white focus:ring-2 focus:ring-indigo-500",children:s.map(i=>t.jsx("option",{value:i.deviceId,children:i.label||`Camera ${i.deviceId.slice(0,5)}...`},i.deviceId))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-400",children:"Microphone"}),t.jsx("select",{value:k,onChange:i=>X(i.target.value),className:"w-full rounded-lg border-none bg-gray-700 px-3 py-2 text-white focus:ring-2 focus:ring-indigo-500",children:r.map(i=>t.jsx("option",{value:i.deviceId,children:i.label||`Mic ${i.deviceId.slice(0,5)}...`},i.deviceId))})]}),t.jsx("button",{onClick:T,className:"mt-4 w-full rounded-lg bg-indigo-600 px-4 py-3 font-bold text-white transition-colors hover:bg-indigo-700",children:"Start Streaming"})]})]})})}class Ge{ws;device=null;sendTransport;recvTransport;producers=new Map;consumers=new Map;audioProducer=null;videoProducer=null;roomId;clientId;deviceLoadedPromise;deviceLoadedResolver=null;transportReadyPromise;transportReadyResolver=null;onTrackCallback=null;onTrackEndedCallback=null;constructor(s,o,r){this.ws=new WebSocket(s),this.roomId=o,this.clientId=r,this.deviceLoadedPromise=new Promise(h=>{this.deviceLoadedResolver=h}),this.transportReadyPromise=new Promise(h=>{this.transportReadyResolver=h}),console.log("[CLIENT] WebRTC Client Created, room:",o,"client:",r)}onTrack(s){this.onTrackCallback=s}onTrackEnded(s){this.onTrackEndedCallback=s}onMessage(s){this.ws.onmessage=o=>{const r=JSON.parse(o.data);console.log(`[CLIENT] WS RECV: ${r.action}`,r),r.action==="restart-ice-done"&&this.handleRestartIceDone(r.data),r.action==="create-recv-transport"&&this.createRecvTransport(r.data),r.action==="new-producer"&&this.consume(r.data.producerId),r.action==="producer-closed"&&this.handleProducerClosed(r.data),r.action==="consume-done"&&this.handleConsumeDone(r.data),r.action==="session-ended"&&(console.warn("[CLIENT] Session ended by server (restart?), reloading..."),window.location.reload()),s(r)}}handleProducerClosed(s){const{producerId:o}=s;console.log("[CLIENT] Producer closed:",o);for(const[r,h]of this.consumers)if(h.producerId===o){console.log("[CLIENT] Closing consumer:",r),h.close(),this.consumers.delete(r),this.onTrackEndedCallback&&this.onTrackEndedCallback(h.track.id);break}}send(s){const o={...s,clientId:this.clientId};console.log(`[CLIENT] WS SEND: ${s.action}`,o),this.ws.send(JSON.stringify(o))}async init(){return new Promise(s=>{this.connectWs(s)})}connectWs(s){this.ws=new WebSocket(this.ws.url),this.ws.onopen=()=>{console.log("[CLIENT] WS CONNECTED"),this.send({action:"join-as-streamer",roomId:this.roomId}),this.send({action:"create-recv-transport",roomId:this.roomId}),s&&s()},this.ws.onclose=()=>{console.log("[CLIENT] WS CLOSED, reconnecting in 3s..."),setTimeout(()=>this.connectWs(),3e3)},this.ws.onerror=o=>{console.error("[CLIENT] WS ERROR:",o),this.ws.close()},this.onMessage(o=>{})}async loadDevice(s){console.log("[CLIENT] Loading device with capabilities:",s),this.device=new $e.Device,await this.device.load({routerRtpCapabilities:s}),console.log("[CLIENT] Device loaded"),this.deviceLoadedResolver&&this.deviceLoadedResolver()}async createSendTransport(s){if(console.log("[CLIENT] createSendTransport options received:",s),!s){console.error("[CLIENT] ERROR! createSendTransport called with EMPTY options");return}if(await this.deviceLoadedPromise,!this.device){console.error("[CLIENT] Device is null after waiting!");return}this.sendTransport=this.device.createSendTransport(s),this.transportReadyResolver&&this.transportReadyResolver(),this.sendTransport.on("connect",({dtlsParameters:o},r)=>{console.log("[CLIENT] Transport connect"),this.send({action:"connect-transport",roomId:this.roomId,data:{transportId:this.sendTransport.id,dtlsParameters:o}}),r()}),this.sendTransport.on("connectionstatechange",async o=>{console.log(`[CLIENT] Send Transport connection state changed: ${o}`),(o==="failed"||o==="disconnected")&&(console.warn("[CLIENT] Transport failed/disconnected. Not restarting ICE to avoid loops. Reloading..."),window.location.reload())}),this.sendTransport.on("produce",({kind:o,rtpParameters:r},h)=>{console.log("[CLIENT] Transport produce"),this.send({action:"produce",roomId:this.roomId,data:{transportId:this.sendTransport.id,kind:o,rtpParameters:r}});const v=x=>{const k=JSON.parse(x.data);k.action==="produce-done"&&(console.log("[CLIENT] producer created:",k.producerId),h({id:k.producerId}),this.ws.removeEventListener("message",v))};this.ws.addEventListener("message",v)})}async produceStream(s){if(await this.transportReadyPromise,!this.sendTransport){console.error("[CLIENT] sendTransport is not ready!");return}const o=s.getVideoTracks()[0];o&&(console.log("[CLIENT] Producing video track..."),this.videoProducer=await this.sendTransport.produce({track:o}),this.producers.set("video",this.videoProducer));const r=s.getAudioTracks()[0];r&&(console.log("[CLIENT] Producing audio track..."),this.audioProducer=await this.sendTransport.produce({track:r}),this.producers.set("audio",this.audioProducer))}async replaceVideoTrack(s){this.videoProducer&&await this.videoProducer.replaceTrack({track:s})}async replaceAudioTrack(s){this.audioProducer&&await this.audioProducer.replaceTrack({track:s})}muteAudio(){this.audioProducer&&this.audioProducer.pause()}unmuteAudio(){this.audioProducer&&this.audioProducer.resume()}pauseVideo(){this.videoProducer&&this.videoProducer.pause()}resumeVideo(){this.videoProducer&&this.videoProducer.resume()}restartIce(s){this.send({action:"restart-ice",roomId:this.roomId,data:{transportId:s}})}async handleRestartIceDone(s){const{transportId:o,iceParameters:r}=s;this.sendTransport&&this.sendTransport.id===o&&(console.log("[CLIENT] Restarting ICE with new parameters"),await this.sendTransport.restartIce({iceParameters:r}))}handleAdminAction(s,o){switch(console.log(`[CLIENT] Handling admin action: ${s}`,o),s){case"mute-audio":this.muteAudio();break;case"unmute-audio":this.unmuteAudio();break;case"mute-video":this.pauseVideo();break;case"unmute-video":this.resumeVideo();break;case"reload":window.location.reload();break;default:console.warn(`[CLIENT] Unknown admin action: ${s}`)}}async createRecvTransport(s){if(console.log("[CLIENT] createRecvTransport options received:",s),await this.deviceLoadedPromise,!this.device){console.error("[CLIENT] Device is null after waiting!");return}this.recvTransport=this.device.createRecvTransport(s),this.recvTransport.on("connect",({dtlsParameters:o},r)=>{console.log("[CLIENT] Recv Transport connect"),this.send({action:"connect-transport",roomId:this.roomId,data:{transportId:this.recvTransport.id,dtlsParameters:o}}),r()}),this.recvTransport.on("connectionstatechange",async o=>{console.log(`[CLIENT] Recv Transport connection state changed: ${o}`)})}async consume(s){if(console.log("[CLIENT] Attempting to consume producer:",s),await this.deviceLoadedPromise,!this.device||!this.recvTransport){console.warn("[CLIENT] Device or RecvTransport not ready");return}const o=this.device.rtpCapabilities;this.send({action:"consume",roomId:this.roomId,data:{transportId:this.recvTransport.id,producerId:s,rtpCapabilities:o}})}async handleConsumeDone(s){const{id:o,producerId:r,kind:h,rtpParameters:v}=s;if(console.log("[CLIENT] handleConsumeDone:",o,h),!this.recvTransport)return;const x=await this.recvTransport.consume({id:o,producerId:r,kind:h,rtpParameters:v});this.consumers.set(x.id,x),this.onTrackCallback&&this.onTrackCallback(x.track),this.send({action:"resume-consumer",roomId:this.roomId,data:{consumerId:x.id}})}close(){console.log("[CLIENT] Closing client..."),this.producers.forEach(s=>{s.close()}),this.producers.clear(),this.consumers.forEach(s=>{s.close()}),this.consumers.clear(),this.sendTransport&&(this.sendTransport.close(),this.sendTransport=null),this.recvTransport&&(this.recvTransport.close(),this.recvTransport=null),this.ws&&this.ws.close(),console.log("[CLIENT] Client closed")}}function Ze(){const e=Me.c(101),s=n.useRef(null),[o,r]=n.useState(!1),[h,v]=n.useState(0),[x,k]=n.useState(!1),[X,y]=n.useState(!1),[a,N]=n.useState(null),[d,g]=n.useState(null),[b,j]=n.useState(!0),[f,Q]=n.useState(!0),[T,i]=n.useState(null),C=n.useRef(null);let E;e[0]===Symbol.for("react.memo_cache_sentinel")?(E=[],e[0]=E):E=e[0];const[w,Ae]=n.useState(E);let Z;e[1]===Symbol.for("react.memo_cache_sentinel")?(Z=[],e[1]=Z):Z=e[1];const[xe,_e]=n.useState(Z),[be,Re]=n.useState(""),[we,De]=n.useState("");let ee,te;e[2]===Symbol.for("react.memo_cache_sentinel")?(ee=()=>{const c=async()=>{try{const p=await navigator.mediaDevices.enumerateDevices(),l=p.filter(qe),m=p.filter(Ye);Ae(l),_e(m),l.length>0&&Re(l[0].deviceId),m.length>0&&De(m[0].deviceId)}catch(p){console.error("[PAGE] Failed to enumerate devices:",p)}};return c(),navigator.mediaDevices.addEventListener("devicechange",c),()=>navigator.mediaDevices.removeEventListener("devicechange",c)},te=[],e[2]=ee,e[3]=te):(ee=e[2],te=e[3]),n.useEffect(ee,te);let se;if(e[4]===Symbol.for("react.memo_cache_sentinel")){se=(p,l,m)=>{N(p),Q(l),j(m),k(!0),c(p)};const c=p=>{let l=localStorage.getItem("stream_room_id");l||(l=`client-${Date.now()}`,localStorage.setItem("stream_room_id",l));let m=sessionStorage.getItem(`stream_connection_id_${l}`);m||(m=crypto.randomUUID(),sessionStorage.setItem(`stream_connection_id_${l}`,m)),Ve.post(`/api/rooms/${l}/join`,{connection_id:m}).then(()=>{console.log("[PAGE] Session created in DB");const I=new Ge("wss://eyeserver.mytro.in",l,m);g(I),I.onTrack(u=>{console.log("[PAGE] Received remote track:",u.kind,u.id),u.kind==="audio"&&i(u)}),I.onTrackEnded(u=>{console.log("[PAGE] Track ended:",u),i(Pe=>Pe&&Pe.id===u?null:Pe)}),I.init().then(()=>{I.onMessage(async u=>{u.action==="router-rtp-capabilities"&&await I.loadDevice(u.data),u.action==="create-send-transport"&&u.data&&await I.createSendTransport(u.data),u.action==="start-produce"&&(await I.produceStream(p),r(!0)),u.action==="viewer-count"&&v(u.count),u.action==="session-ended"&&(console.warn("[PAGE] Session ended by server, reloading..."),window.location.reload()),u.action==="admin-action"&&I&&I.handleAdminAction(u.data.type,u.data.payload)})})}).catch(Je)};e[4]=se}else se=e[4];let oe;e[5]!==a?(oe=()=>{s.current&&a&&(s.current.srcObject=a)},e[5]=a,e[6]=oe):oe=e[6];let re;e[7]!==o||e[8]!==a?(re=[a,o],e[7]=o,e[8]=a,e[9]=re):re=e[9],n.useEffect(oe,re);let ie,ae;e[10]!==T?(ie=()=>{if(C.current&&T){console.log("[PAGE] Playing remote audio track");const c=new MediaStream([T]);C.current.srcObject=c,C.current.play().catch(Fe)}},ae=[T],e[10]=T,e[11]=ie,e[12]=ae):(ie=e[11],ae=e[12]),n.useEffect(ie,ae);let ne;e[13]!==b||e[14]!==d?(ne=()=>{d&&(b?d.muteAudio():d.unmuteAudio(),j(!b))},e[13]=b,e[14]=d,e[15]=ne):ne=e[15];const ke=ne;let ce;e[16]!==d||e[17]!==f?(ce=()=>{d&&(f?d.pauseVideo():d.resumeVideo(),Q(!f))},e[16]=d,e[17]=f,e[18]=ce):ce=e[18];const ye=ce;let de;e[19]!==d||e[20]!==a?(de=async c=>{try{const l=(await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:c}}})).getVideoTracks()[0];if(d&&await d.replaceVideoTrack(l),a){const m=a.getVideoTracks()[0];m&&(a.removeTrack(m),m.stop()),a.addTrack(l),s.current&&(s.current.srcObject=a)}Re(c),Q(!0)}catch(p){console.error("[PAGE] Failed to switch camera:",p)}},e[19]=d,e[20]=a,e[21]=de):de=e[21];const Te=de;let le;e[22]!==d||e[23]!==a?(le=async c=>{try{const l=(await navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:c}}})).getAudioTracks()[0];if(d&&await d.replaceAudioTrack(l),a){const m=a.getAudioTracks()[0];m&&(a.removeTrack(m),m.stop()),a.addTrack(l)}De(c),j(!0)}catch(p){console.error("[PAGE] Failed to switch microphone:",p)}},e[22]=d,e[23]=a,e[24]=le):le=e[24];const Ie=le;let ue;e[25]!==d||e[26]!==a?(ue=()=>{confirm("Are you sure you want to end the stream?")&&(d&&d.close(),a&&a.getTracks().forEach(ze),r(!1),y(!0))},e[25]=d,e[26]=a,e[27]=ue):ue=e[27];const Ne=ue;if(X){let c;return e[28]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-100 p-6 dark:bg-gray-900",children:t.jsxs("div",{className:"w-full max-w-md rounded-xl bg-white p-8 text-center shadow-xl dark:bg-gray-800",children:[t.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900",children:t.jsx("svg",{className:"h-8 w-8 text-red-600 dark:text-red-200",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("h2",{className:"mb-2 text-2xl font-bold text-gray-900 dark:text-white",children:"Stream Ended"}),t.jsx("p",{className:"mb-6 text-gray-500 dark:text-gray-400",children:"The streaming session has been terminated."}),t.jsx("button",{onClick:He,className:"rounded-lg bg-blue-600 px-6 py-2 font-medium text-white hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:outline-none dark:focus:ring-offset-gray-800",children:"Start New Stream"})]})}),e[28]=c):c=e[28],c}if(!x){let c;return e[29]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(We,{onReady:se}),e[29]=c):c=e[29],c}let me;e[30]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Client Streaming"}),e[30]=me):me=e[30];let S;e[31]!==o?(S=o?t.jsxs("span",{className:"inline-flex items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800 dark:bg-red-900 dark:text-red-200",children:[t.jsx("span",{className:"mr-1.5 h-2 w-2 rounded-full bg-red-600"}),"LIVE"]}):t.jsx("span",{className:"inline-flex items-center rounded-full bg-yellow-100 px-2.5 py-0.5 text-xs font-medium text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"CONNECTING"}),e[31]=o,e[32]=S):S=e[32];let L;e[33]!==h?(L=t.jsxs("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:[h," Viewers"]}),e[33]=h,e[34]=L):L=e[34];let P;e[35]!==S||e[36]!==L?(P=t.jsx("div",{className:"border-b border-gray-200 p-4 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[me,t.jsxs("div",{className:"flex items-center gap-2",children:[S,L]})]})}),e[35]=S,e[36]=L,e[37]=P):P=e[37];const je=`h-full w-full object-cover ${f?"":"opacity-50"}`;let R;e[38]!==je?(R=t.jsx("video",{ref:s,autoPlay:!0,muted:!0,playsInline:!0,className:je}),e[38]=je,e[39]=R):R=e[39];let D;e[40]!==f?(D=!f&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:"Camera Paused"}),e[40]=f,e[41]=D):D=e[41];let he;e[42]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx("audio",{ref:C,autoPlay:!0}),e[42]=he):he=e[42];let A;e[43]!==T?(A=T&&t.jsxs("div",{className:"absolute top-4 right-4 flex animate-pulse items-center gap-2 rounded-full bg-red-600 px-3 py-1 text-white shadow-lg",children:[t.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})}),t.jsx("span",{className:"text-xs font-bold",children:"Admin Speaking"})]}),e[43]=T,e[44]=A):A=e[44];const Ce=`rounded-full p-3 ${b?"bg-white/20 text-white hover:bg-white/30":"bg-red-500 text-white hover:bg-red-600"} backdrop-blur-sm transition-colors`,Ee=b?"Mute Mic":"Unmute Mic";let _;e[45]!==b?(_=b?t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}):t.jsxs("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"})]}),e[45]=b,e[46]=_):_=e[46];let M;e[47]!==Ce||e[48]!==Ee||e[49]!==_||e[50]!==ke?(M=t.jsx("button",{onClick:ke,className:Ce,title:Ee,children:_}),e[47]=Ce,e[48]=Ee,e[49]=_,e[50]=ke,e[51]=M):M=e[51];let V;e[52]!==a?(V=a?.getAudioTracks()[0]&&t.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-black/50 px-3 py-2 backdrop-blur-sm",children:[t.jsx("span",{className:"text-xs text-white",children:"Mic Level:"}),t.jsx(Oe,{track:a.getAudioTracks()[0]})]}),e[52]=a,e[53]=V):V=e[53];const Se=`rounded-full p-3 ${f?"bg-white/20 text-white hover:bg-white/30":"bg-red-500 text-white hover:bg-red-600"} backdrop-blur-sm transition-colors`,Le=f?"Turn Off Camera":"Turn On Camera";let $;e[54]!==f?($=f?t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}):t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),e[54]=f,e[55]=$):$=e[55];let O;e[56]!==Se||e[57]!==Le||e[58]!==$||e[59]!==ye?(O=t.jsx("button",{onClick:ye,className:Se,title:Le,children:$}),e[56]=Se,e[57]=Le,e[58]=$,e[59]=ye,e[60]=O):O=e[60];let W;e[61]!==M||e[62]!==V||e[63]!==O?(W=t.jsxs("div",{className:"absolute right-0 bottom-0 left-0 flex justify-center gap-4 bg-gradient-to-t from-black/80 to-transparent p-4 opacity-0 transition-opacity group-hover:opacity-100",children:[M,V,O]}),e[61]=M,e[62]=V,e[63]=O,e[64]=W):W=e[64];let G;e[65]!==R||e[66]!==D||e[67]!==A||e[68]!==W?(G=t.jsxs("div",{className:"group relative aspect-video bg-black",children:[R,D,he,A,W]}),e[65]=R,e[66]=D,e[67]=A,e[68]=W,e[69]=G):G=e[69];let fe;e[70]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Camera"}),e[70]=fe):fe=e[70];let U;e[71]!==Te?(U=c=>Te(c.target.value),e[71]=Te,e[72]=U):U=e[72];let B;e[73]!==w?(B=w.map(Be),e[73]=w,e[74]=B):B=e[74];let H;e[75]!==be||e[76]!==U||e[77]!==B?(H=t.jsxs("div",{className:"min-w-[200px] flex-1",children:[fe,t.jsx("select",{value:be,onChange:U,className:"w-full rounded-lg border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:B})]}),e[75]=be,e[76]=U,e[77]=B,e[78]=H):H=e[78];let pe;e[79]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Microphone"}),e[79]=pe):pe=e[79];let z;e[80]!==Ie?(z=c=>Ie(c.target.value),e[80]=Ie,e[81]=z):z=e[81];let F;e[82]!==xe?(F=xe.map(Ue),e[82]=xe,e[83]=F):F=e[83];let J;e[84]!==we||e[85]!==z||e[86]!==F?(J=t.jsxs("div",{className:"min-w-[200px] flex-1",children:[pe,t.jsx("select",{value:we,onChange:z,className:"w-full rounded-lg border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:F})]}),e[84]=we,e[85]=z,e[86]=F,e[87]=J):J=e[87];let Y;e[88]!==H||e[89]!==J?(Y=t.jsxs("div",{className:"mb-4 flex flex-wrap gap-4",children:[H,J]}),e[88]=H,e[89]=J,e[90]=Y):Y=e[90];let ge;e[91]===Symbol.for("react.memo_cache_sentinel")?(ge=t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Share your stream ID:"," ",t.jsx("code",{className:"rounded bg-gray-100 px-1 py-0.5 font-mono text-gray-800 dark:bg-gray-700 dark:text-gray-200",children:localStorage.getItem("stream_room_id")})]}),e[91]=ge):ge=e[91];let q;e[92]!==Ne?(q=t.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4 dark:border-gray-700",children:[ge,t.jsx("button",{onClick:Ne,className:"rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:outline-none dark:focus:ring-offset-gray-800",children:"End Stream"})]}),e[92]=Ne,e[93]=q):q=e[93];let K;e[94]!==Y||e[95]!==q?(K=t.jsxs("div",{className:"p-4",children:[Y,q]}),e[94]=Y,e[95]=q,e[96]=K):K=e[96];let ve;return e[97]!==P||e[98]!==G||e[99]!==K?(ve=t.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-100 p-6 dark:bg-gray-900",children:t.jsxs("div",{className:"w-full max-w-2xl overflow-hidden rounded-xl bg-white shadow-xl dark:bg-gray-800",children:[P,G,K]})}),e[97]=P,e[98]=G,e[99]=K,e[100]=ve):ve=e[100],ve}function Ue(e){return t.jsx("option",{value:e.deviceId,children:e.label||`Mic ${e.deviceId.slice(0,5)}...`},e.deviceId)}function Be(e){return t.jsx("option",{value:e.deviceId,children:e.label||`Camera ${e.deviceId.slice(0,5)}...`},e.deviceId)}function He(){return window.location.reload()}function ze(e){return e.stop()}function Fe(e){return console.error("[PAGE] Remote audio play failed:",e)}function Je(e){return console.error("[PAGE] Failed to join room API:",e)}function Ye(e){return e.kind==="audioinput"}function qe(e){return e.kind==="videoinput"}export{Ze as default};
